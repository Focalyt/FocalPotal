<%include ./newpartials/header%>

  <section class="section-padding-top-120 mt-5">
    <div class="container-fluid p-0">
      <div class="mainContentLayout">
        <!-- Header -->
        <!-- <div class="blog_header">
          Left Section: Logo and Search
          <div class="blog_logo">
            <div class="blogFocalLogo">
              <figure>
                <img src="public_assets/images/whatsappicon.png" alt="Logo" />
              </figure>
            </div>
            <div class="blogSearch">
              <input type="search" class="searchbox">
          
            </div>
          </div>
    
          Right Section: Navigation Links
          <div class="blog_navigation">
            <div class="nav_item">
              <img src="public_assets/images/home_icon.png" alt="Home" />
              <span class="nav_item_span">Home</span>
            </div>
            <div class="nav_item">
              <img src="public_assets/images/network_icon.png" alt="My Network" />
              <span class="nav_item_span">My Network</span>
            </div>
            <div class="nav_item">
              <img src="public_assets/images/jobs_icon.png" alt="Jobs" />
              <span class="nav_item_span">Jobs</span>
            </div>
            <div class="nav_item">
              <img src="public_assets/images/messaging_icon.png" alt="Messaging" />
              <span class="nav_item_span">Messaging</span>
            </div>
            <div class="nav_item">
              <img src="public_assets/images/notifications_icon.png" alt="Notifications" />
              <span class="nav_item_span">Notifications</span>
            </div>
          </div>
        </div> -->

        <!-- Main Content -->
        <div class="mainContainer">
          <div class="leftSidebar">
            <div class="sidebar">
              <!-- Notification Banner -->
              <div class="notification">
                <span class="close">√ó</span>
                <h4>New Lab Program!</h4>
                <p>Special funding available for STEM labs</p>
              </div>
          
              <!-- Lab Programs -->
              <div class="section">
                <div class="section-titles">
                  üß™ Lab Programs
                </div>
                <div class="lab-card">
                  <h4>Computer Lab Setup</h4>
                  <p>Starting at ‚Çπ2,00,000</p>
                </div>
                <div class="lab-card">
                  <h4>Science Lab Package</h4>
                  <p>Starting at ‚Çπ1,50,000</p>
                </div>
              </div>
          
              <!-- Latest Updates -->
              <div class="section">
                <div class="section-titles">
                  üì∞ Latest Updates
                </div>
                <div class="news-item">
                  <h4>New Government Initiative</h4>
                  <p>Extra funding for rural schools</p>
                </div>
                <div class="news-item">
                  <h4>Success Story</h4>
                  <p>100 labs established in Bihar</p>
                </div>
              </div>
          
              <!-- Special Offers -->
              <div class="section">
                <div class="section-titles">
                  üéÅ Special Offers
                </div>
                <div class="offer-card green">
                  <strong>15% OFF</strong>
                  <span>on complete lab setup</span>
                </div>
                <div class="offer-card orange">
                  <strong>Free Training</strong>
                  <span>with every lab installation</span>
                </div>
              </div>
          
              <!-- Success Stories -->
              <div class="section">
                <div class="section-titles">
                  üèÜ Success Stories
                </div>
                <div class="success-item">
                  <span>üè´</span>
                  <span>DPS School - 5 Labs</span>
                </div>
                <div class="success-item">
                  <span>üè´</span>
                  <span>St. Xavier's - 3 Labs</span>
                </div>
              </div>
            </div>

          </div>
          <div class="mainBody">
            <% if (posts && posts.length> 0) { %>
              <% posts.forEach((post)=> { %>
                <div class="blog--card" id="post-<%= post._id ? post._id : 'post-' + index %>">
                  <!-- Header Section -->
                  <div class="card-header">
                    <div class="inner__card">
                      <div class="user_image text-black">
                        <figure>
                          <img src="public_assets/images/newpage/favicon.png" alt>
                        </figure>

                      </div>
                      <h3 class="user__name text-black">
                        <span class="start__name"><b>Focalyt</b></span>
                        
                        <% if (post.tags && post.tags.length > 0) { %>
                          <span class="tag__user">
                            is with <b><%= post.tags[0].name %></b>
                          </span>
                      
                          <% if (post.tags.length > 1) { %>
                            <span class="more__user strong"> & <b><%= post.tags.length - 1 %></b></span>
                            <span class="other"><b> Others</b></span>
                          <% } %>
                        <% } %>
                      </h3>
                      



                    </div>

                    <!-- <h5 class="blog__title text-black">Secure Your Future with Cybersecurity! <span>more...</span></h5> -->
                    <h5 class="blog__title text-black">
                      <span class="hidden-text">
                        <%= post.content || "No content available" %>
                      </span>
                      <span class="toggle-more see-more-hidden">See more...</span> <!-- Changed ID to class -->
                    </h5>


                  </div>

                  <!-- Main Content -->
                  <div class="card-content" id="post-<%= post._id || index %>">
                    <div class="card-image">
                      <div class="happy_candidates" id="blog--images">
                        <div class="happy_candidate_images">
                          <% if (post.files && post.files.length> 0) { %>
                            <% post.files.forEach((file)=> { %>
                              <% if (file.fileType==="image" ) { %>
                                <div>
                                  <img src="<%= file.fileURL %>" class="d-block w-100" alt="image">
                                </div>
                                <% } else if (file.fileType==="video" ) { %>
                                  <div>
                                    <video class="d-block w-100 video_height lazy-video" muted controls autoplay
                                      playsinline>
                                      <source src="<%= file.fileURL %>" type="video/mp4">
                                      Your browser does not support the video tag.
                                    </video>
                                  </div>
                                  <% } %>
                                    <% }); %>
                                      <% } %>



                        </div>
                      </div>
                    </div>
                    <!-- <div class="count_section">
                      <div class="count_item">
                        <i class="fas fa-thumbs-up"></i>
                        <span>50K</span>
                      </div>

                      <div class="inner_count_section">
                        <div class="count_item">
                          <i class="fas fa-comments"></i>
                          <span>474</span>
                        </div>
                        <div class="count_item">
                          <i class="fas fa-share"></i>
                          <span>379</span>
                        </div>
                      </div>

                    </div> -->
                    <!-- Like, Comment, and Share Buttons -->
                    <div class="interaction-buttons d-flex align-items-center justify-content-center">
                                       
                      <div class="share_link">
                        <i class="fas fa-share"></i> Share
                      </div>
                    </div>
                    <!-- <div class="interaction-buttons d-flex align-items-center justify-content-between">
                      <div class="like">
                        <i class="fas fa-thumbs-up"></i> Like

                      </div>
                      <div class="comment">
                        <i class="fas fa-comment-alt"></i> Comment

                      </div>
                      <div class="share_link">
                        <i class="fas fa-share"></i> Share
                      </div>
                    </div> -->
                    <!-- <div class="comment_box">
                      <textarea rows="1" placeholder="Write a comment..."></textarea>
                      <a href="#" class="shareBtn">
                        <img src="/public_assets/images/icons/share.png" alt="">
                      </a>
                    </div> -->
                  </div>

                </div>
                <% }); %>
                  <% } else { %>
                    <p>No posts available.</p>
                    <% } %>

            
          </div>
        </div>
      </div>
  </section>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const blogCards = document.querySelectorAll(".blog--card"); // Sabhi blog cards ko target karein
      blogCards.forEach((card) => {
        const hiddenText = card.querySelector(".hidden-text"); // Card ke text ko target karein
        const toggleMore = card.querySelector(".toggle-more"); // Card ke toggle button ko target karein

        if (hiddenText && toggleMore) {
          // Function to check if text is truncated
          function isTextTruncated(element) {
            const computedStyle = window.getComputedStyle(element);
            const lineHeight = parseFloat(computedStyle.lineHeight); // Line height calculate karein
            const maxLines = 4; // Max 4 lines ki limit
            const actualLines = Math.ceil(element.scrollHeight / lineHeight); // Total lines calculate karein

            return actualLines > maxLines; // True agar 4 lines se zyada hai
          }

          // Function to handle toggle-more visibility
          function handleToggleVisibility() {
            if (isTextTruncated(hiddenText)) {
              toggleMore.classList.remove("see-more-hidden"); // Button visible karein
              toggleMore.classList.add("see-more-visible"); // Visible class add karein
            } else {
              toggleMore.classList.remove("see-more-visible"); // Button hidden karein
              toggleMore.classList.add("see-more-hidden"); // Hidden class add karein
            }
          }

          // Initial visibility check
          handleToggleVisibility();



          // Toggle visibility on button click
          toggleMore.addEventListener("click", function () {
            if (hiddenText.classList.contains("hidden-text")) {
              hiddenText.classList.remove("hidden-text");
              hiddenText.classList.add("show-text"); // Text pura dikhane ke liye class change karein
              toggleMore.textContent = "See less..."; // Button text update karein
            } else {
              hiddenText.classList.remove("show-text");
              hiddenText.classList.add("hidden-text"); // Text phir se chhupane ke liye class change karein
              toggleMore.textContent = "See more..."; // Button text update karein
            }
          });

          // COMMENT FUNCTIONALITY
          const commentButton = card.querySelector(".comment");
          const commentBox = card.querySelector(".comment_box");

          if (commentButton && commentBox) {
            commentButton.addEventListener("click", () => {
              commentBox.classList.toggle("visible");
            });
          }

        }
      });
    });


    document.addEventListener("DOMContentLoaded", function () {
      const videos = document.querySelectorAll(".lazy-video"); // Select all videos with class 'lazy-video'

      // Ensure all videos are paused initially
      videos.forEach((video) => {
        video.pause(); // Start with paused state
      });

      // Create Intersection Observer
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const video = entry.target;


            if (entry.isIntersecting) {

              // Define an async function to handle the play and unmute logic
              const playVideo = async (video) => {
                try {
                  // Start playing the video in muted mode

                  await video.play(); // Wait for the video to start playing

                } catch (error) {
                  console.error("Error while trying to play the video:", error); // Handle autoplay errors
                }
              };

              // Call the async function
              playVideo(video);
            } else {
              // Pause the video when it exits the viewport
              video.pause();
            }
          });
        },
        { threshold: 0.5 } // At least 50% of the video should be visible
      );

      // Observe each video
      videos.forEach((video) => {
        observer.observe(video);
      });
    });


  </script>
<script>
  
  document.addEventListener("DOMContentLoaded", function () {
  const shareLinks = document.querySelectorAll(".share_link");

  shareLinks.forEach((shareLink) => {
    shareLink.addEventListener("click", function () {
      const postElement = shareLink.closest(".blog--card"); // Get closest post container
      const postId = postElement ? postElement.id : null; // Get the post ID

      if (!postId || postId.includes("null")) {
        alert("Error: Post ID not found!");
        return;
      }

      const postUrl = `${window.location.origin}${window.location.pathname}#${postId}`; // Generate sharable URL

      const shareData = {
        title: "Check this out!",
        text: "This is an awesome post. Check it out!",
        url: postUrl,
      };

      // Web Share API
      if (navigator.share) {
        navigator
          .share(shareData)
          .then(() => console.log("Shared successfully!"))
          .catch((error) => console.error("Error sharing:", error));
      } else {
        // Fallback: Copy link to clipboard
        const tempInput = document.createElement("input");
        document.body.appendChild(tempInput);
        tempInput.value = postUrl;
        tempInput.select();
        document.execCommand("copy");
        document.body.removeChild(tempInput);
        alert("Link copied to clipboard! Share it manually.");
      }
    });
  });
});




document.addEventListener("DOMContentLoaded", function () {
    // URL se hash (post ID) nikalna
    const postId = window.location.hash.substring(1);

    if (postId) {
        const postElement = document.getElementById(postId);
        if (postElement) {
            postElement.scrollIntoView({ behavior: "smooth", block: "start" });
        }
    }
});


</script>

<!-- <script>
    document.addEventListener("DOMContentLoaded", function () {
    const blogCards = document.querySelectorAll(".blog--card");
  
    blogCards.forEach((card) => {
      // SEE MORE FUNCTIONALITY
      const toggleMore = card.querySelector(".toggle-more");
      const hiddenText = card.querySelector(".hidden-text");
  
      if (toggleMore && hiddenText) {
        // Function to check if text is truncated
        function isTextTruncated(element) {
          return element.scrollHeight > element.offsetHeight; // Check overflow
        }
  
        // Function to handle "See More" visibility
        function handleToggleMoreVisibility() {
          if (isTextTruncated(hiddenText)) {
            toggleMore.style.display = "block"; // Show button if text is truncated
          } else {
            toggleMore.style.display = "none"; // Hide button if text fits
          }
        }
  
        // Check visibility on page load
        handleToggleMoreVisibility();
  
        // Recheck visibility on resize
        window.addEventListener("resize", handleToggleMoreVisibility);
  
        // Toggle text visibility on click
        toggleMore.addEventListener("click", function () {
          hiddenText.classList.toggle("show"); // Toggle the "show" class
          toggleMore.textContent = hiddenText.classList.contains("show")
            ? "See less..."
            : "See more...";
        });
      }
  
      // COMMENT FUNCTIONALITY
      const commentButton = card.querySelector(".comment");
      const commentBox = card.querySelector(".comment_box");
  
      if (commentButton && commentBox) {
        commentButton.addEventListener("click", () => {
          commentBox.classList.toggle("visible");
        });
      }
  
      // SHARE FUNCTIONALITY
      const shareLink = card.querySelector(".share_link");
      if (shareLink) {
        shareLink.addEventListener("click", () => {
          if (navigator.share) {
            navigator
              .share({
                title: "Check this out!",
                text: "This is an awesome post. Check it out!",
                url: window.location.href, // Current page URL
              })
              .then(() => console.log("Shared successfully!"))
              .catch((error) => console.error("Error sharing:", error));
          } else {
            alert(
              "Web Share API is not supported in your browser. Please use the share options below."
            );
          }
        });
      }
    });
   
  
  });
  
  
   </script> -->
  <%include ./newpartials/footerblog%>